"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{89916:function(e,t,n){n.r(t),n.d(t,{OverviewRoot:function(){return OverviewRoot},default:function(){return t$}});var r,i=n(52322),s=n(2784),o=n(7267),a=n(81862),l=n(85333),c=n(58467),u=n(82550),d=n(22970),h=n(83601),p=n(28888),f=n(17131),x=n(81308),m=n(18399),v=n(86412),g=n(9676),j=n(54266),y=n(63832),b=n(82585),w=n(75168),S=n(54949),k=n(55237),O=n(68028),_=n(61935),T=n(71277),A=n(90437),C=n(85888),E=n(56024),R=n(87631),I=n(40049),OverviewTabs=function(e){var t=e.refreshState,n=e.tab,r=(0,R.dx)();return(0,i.jsxs)(m.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,i.jsxs)(E.mQ,{selectedTabId:n,children:[(0,i.jsx)(I.f,{id:"activity",title:"Activity",to:"/overview/activity"}),(0,i.jsx)(I.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),(0,i.jsx)(I.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),(0,i.jsx)(I.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),(0,i.jsx)(I.f,{id:"amp",title:(0,i.jsxs)(m.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)("div",{children:"Auto-materialize"}),r.loading?(0,i.jsx)(y.$,{purpose:"body-text"}):(0,i.jsx)("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:!1===r.paused?v.w.Blue200:v.w.Gray200}})]}),to:"/overview/automaterialize"}),(0,i.jsx)(I.f,{id:"resources",title:"Resources",to:"/overview/resources"}),(0,i.jsx)(I.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),t?(0,i.jsx)(m.x,{padding:{bottom:8},children:(0,i.jsx)(k.xi,{refreshState:t})}):null]})},z=n(73235),N=n(60138),P=n(91195);function _templateObject(){var e=(0,z._)(["\n  query AssetDaemonTicksQuery(\n    $dayRange: Int\n    $dayOffset: Int\n    $statuses: [InstigationTickStatus!]\n    $limit: Int\n    $cursor: String\n    $beforeTimestamp: Float\n    $afterTimestamp: Float\n  ) {\n    autoMaterializeTicks(\n      dayRange: $dayRange\n      dayOffset: $dayOffset\n      statuses: $statuses\n      limit: $limit\n      cursor: $cursor\n      beforeTimestamp: $beforeTimestamp\n      afterTimestamp: $afterTimestamp\n    ) {\n      id\n      ...AssetDaemonTickFragment\n    }\n  }\n\n  fragment AssetDaemonTickFragment on InstigationTick {\n    id\n    timestamp\n    endTimestamp\n    status\n    instigationType\n    error {\n      ...PythonErrorFragment\n    }\n    requestedAssetKeys {\n      path\n    }\n    requestedAssetMaterializationCount\n    autoMaterializeAssetEvaluationId\n    requestedMaterializationsForAssets {\n      assetKey {\n        path\n      }\n      partitionKeys\n    }\n  }\n  ","\n"]);return _templateObject=function(){return e},e}var F=(0,N.Ps)(_templateObject(),P.B),B=n(87612),L=n(99596),U=n(12084),D=n(83302),M=n(35505),K=n(58701),$=n(88846),q=n(65767),V=n(581);function AutomaterializationEvaluationHistoryTable_templateObject(){var e=(0,z._)(["\n  th,\n  td {\n    vertical-align: middle !important;\n  }\n"]);return AutomaterializationEvaluationHistoryTable_templateObject=function(){return e},e}var AutomaterializationEvaluationHistoryTable=function(e){var t,n,r=e.setSelectedTick,o=e.setTableView,a=e.setTimerange,u=e.setParentStatuses,d=(0,c._)((0,T.q)({queryKey:"statuses",decode:s.useCallback(function(e){var t=e.statuses;return new Set(t?JSON.parse(t):[_.izS.STARTED,_.izS.SUCCESS,_.izS.FAILURE])},[]),encode:s.useCallback(function(e){return{statuses:JSON.stringify(Array.from(e))}},[])}),2),h=d[0],p=d[1],f=(0,q.l)({query:F,variables:{statuses:s.useMemo(function(){return Array.from(h)},[h])},nextCursorForResult:function(e){var t,n=e.autoMaterializeTicks;if(n.length)return null===(t=n[14])||void 0===t?void 0:t.id},getResultArray:function(e){return(null==e?void 0:e.autoMaterializeTicks)?e.autoMaterializeTicks:[]},pageSize:15}),v=f.queryResult,g=f.paginationProps;return(0,k.C4)(v,1e4,!g.hasPrevCursor),s.useEffect(function(){if(g.hasPrevCursor){var e=null===(t=v.data)||void 0===t?void 0:t.autoMaterializeTicks;if(e&&e.length){var t,n,r,i=null===(n=e[e.length-1])||void 0===n?void 0:n.timestamp,s=null===(r=e[0])||void 0===r?void 0:r.endTimestamp;i&&s&&a([i,s])}}else a(void 0)},[g.hasPrevCursor,null===(t=v.data)||void 0===t?void 0:t.autoMaterializeTicks,a]),s.useEffect(function(){g.hasPrevCursor?u(Array.from(h)):u(void 0)},[g.hasPrevCursor,u,h]),(0,i.jsxs)(m.x,{children:[(0,i.jsxs)(m.x,{flex:{justifyContent:"space-between",alignItems:"center"},padding:{vertical:12,horizontal:24},margin:{top:32},border:"top",children:[(0,i.jsxs)(m.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)(L.h,{activeItems:new Set(["evaluations"]),buttons:[{id:"evaluations",label:"Evaluations"},{id:"runs",label:"Runs"}],onClick:function(e){o(e)}}),v.data?null:(0,i.jsx)(y.$,{purpose:"body-text"})]}),(0,i.jsxs)(m.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[(0,i.jsx)(StatusCheckbox,{statuses:h,setStatuses:p,status:_.izS.STARTED}),(0,i.jsx)(StatusCheckbox,{statuses:h,setStatuses:p,status:_.izS.SUCCESS}),(0,i.jsx)(StatusCheckbox,{statuses:h,setStatuses:p,status:_.izS.FAILURE}),(0,i.jsx)(StatusCheckbox,{statuses:h,setStatuses:p,status:_.izS.SKIPPED})]})]}),(0,i.jsxs)(G,{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:120},children:"Timestamp"}),(0,i.jsx)("th",{style:{width:90},children:"Status"}),(0,i.jsx)("th",{style:{width:90},children:"Duration"}),(0,i.jsx)("th",{style:{width:180},children:"Result"})]})}),(0,i.jsx)("tbody",{children:null===(n=v.data||v.previousData)||void 0===n?void 0:n.autoMaterializeTicks.map(function(e,t){var n=0!==t&&e.status===_.izS.STARTED&&!g.hasPrevCursor;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(K.E,{timestamp:{unix:e.timestamp},timeFormat:{showTimezone:!0}})}),(0,i.jsx)("td",{children:(0,i.jsx)(V.a,{tick:e,isStuckStarted:n})}),(0,i.jsx)("td",{children:n?" - ":(0,i.jsx)($.Q,{startUnix:e.timestamp,endUnix:e.endTimestamp})}),(0,i.jsx)("td",{children:[_.izS.SKIPPED,_.izS.SUCCESS].includes(e.status)?(0,i.jsx)(U.Z,{onClick:function(){r(e)},children:(0,i.jsxs)(x.pN,{children:[e.requestedAssetMaterializationCount," materializations requested"]})}):" - "})]},e.id)})})]}),(0,i.jsx)("div",{style:{paddingBottom:"16px"},children:(0,i.jsx)(D.pI,(0,l._)({},g))})]})},J=(r={},(0,B._)(r,_.izS.SKIPPED,"None requested"),(0,B._)(r,_.izS.STARTED,"Started"),(0,B._)(r,_.izS.FAILURE,"Failed"),(0,B._)(r,_.izS.SUCCESS,"Requested"),r);function StatusCheckbox(e){var t=e.status,n=e.statuses,r=e.setStatuses;return(0,i.jsx)(b.X,{label:J[t],checked:n.has(t),onChange:function(){var e=new Set(n);n.has(t)?e.delete(t):e.add(t),r(e)}})}var G=(0,M.ZP)(j.i).withConfig({componentId:"sc-3912b009-0"})(AutomaterializationEvaluationHistoryTable_templateObject()),W=n(40794),H=n(34e3),Q=n(68577),Z=n(47933),X=n(35157),Y=n(32911),ee=n(55658),et=n(37160),en=n(38153),er=n(28090),ei=n(55798),es=n(74711);function AutomaterializationTickDetailDialog_templateObject(){var e=(0,z._)(["\n  display: grid;\n  grid-template-columns: ",";\n  height: 100%;\n  > * {\n    justify-content: center;\n  }\n"]);return AutomaterializationTickDetailDialog_templateObject=function(){return e},e}function _templateObject1(){var e=(0,z._)(["\n  query AssetGroupAndLocationQuery($assetKey: AssetKeyInput!) {\n    assetOrError(assetKey: $assetKey) {\n      ... on Asset {\n        id\n        definition {\n          id\n          groupName\n          repository {\n            id\n            name\n            location {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return _templateObject1=function(){return e},e}var eo="30% 17% 53%",ea=s.memo(function(e){var t=e.tick,n=e.isOpen,r=e.close,o=(0,c._)(s.useState(""),2),a=o[0],l=o[1],u=s.useMemo(function(){return t?t.requestedAssetKeys.filter(function(e){return e.path.join("/").includes(a)}):[]},[t,a]),d=(null==t?void 0:t.requestedAssetKeys.length)||0,h=s.useRef(null),p=(0,Q.useVirtualizer)({count:u.length,getScrollElement:function(){return h.current},estimateSize:function(){return 34},overscan:10}),f=p.getTotalSize(),g=p.getVirtualItems(),j=s.useMemo(function(){var e={};return null==t||t.requestedMaterializationsForAssets.forEach(function(t){var n=t.assetKey,r=t.partitionKeys;e[(0,X.Je)(n)]=r}),e},[null==t?void 0:t.requestedMaterializationsForAssets]),y=s.useMemo(function(){return a&&!u.length?(0,i.jsx)(ei.LS,{title:"No matching asset keys",description:(0,i.jsxs)(i.Fragment,{children:["No matching asset keys for ",(0,i.jsx)("strong",{children:a})]})}):(null==t?void 0:t.requestedAssetKeys.length)?(0,i.jsxs)("div",{style:{overflow:"scroll"},ref:h,children:[(0,i.jsxs)(m.x,{border:"top-and-bottom",style:{display:"grid",gridTemplateColumns:eo,height:"32px",fontSize:"12px",color:v.w.Gray600,position:"sticky",top:0,zIndex:1,background:v.w.White},children:[(0,i.jsx)(ee.qN,{children:"Asset"}),(0,i.jsx)(ee.qN,{children:"Group"}),(0,i.jsx)(ee.qN,{children:"Result"})]}),(0,i.jsx)(ee.Nh,{$totalHeight:f,children:g.map(function(e){var n=e.index,r=e.key,s=e.size,o=e.start,a=u[n];return(0,i.jsx)(AssetDetailRow,{$height:s,$start:o,assetKey:a,partitionKeys:j[(0,X.Je)(a)],evaluationId:t.autoMaterializeAssetEvaluationId},r)})})]}):(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},children:(0,i.jsx)(x.YS,{color:v.w.Gray700,children:"None"})})},[j,u,g,a,t,f]);return(0,i.jsx)(ei.Vm,{isOpen:n,setIsOpen:r,height:400,header:(0,i.jsx)(ei.Lv,{title:t?(0,i.jsx)("div",{children:(0,i.jsx)(K.E,{timestamp:{unix:t.timestamp},timeFormat:{showTimezone:!0}})}):"",showSearch:d>0,placeholder:"Filter by asset key…",queryString:a,setQueryString:l}),content:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateRows:"auto auto minmax(0, 1fr)",height:"100%"},children:[(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:t?(0,i.jsx)(Y.c,{tick:t}):null}),(null==t?void 0:t.status)===_.izS.STARTED?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},border:u.length>0?void 0:"bottom",children:(0,i.jsx)(x.Tj,{children:"Materializations requested"})}),y]})]})})}),AssetDetailRow=function(e){var t=e.$start,n=e.$height,r=e.assetKey,s=e.partitionKeys,o=e.evaluationId,a=(null==s?void 0:s.length)||1,l=(0,W.a)(ec,{fetchPolicy:"cache-and-network",variables:{assetKey:{path:r.path}}}).data,c=(null==l?void 0:l.assetOrError.__typename)==="Asset"?l.assetOrError:null,u=null==c?void 0:c.definition,d=u?(0,et.kQ)(u.repository.name,u.repository.location.name):null;return(0,i.jsx)(ee.X2,{$start:t,$height:n,children:(0,i.jsxs)(el,{border:"bottom",children:[(0,i.jsx)(ee.E5,{children:(0,i.jsx)(er.R,{path:r.path,icon:"asset",textStyle:"middle-truncate"})}),(0,i.jsx)(ee.E5,{children:l?u&&u.groupName&&d?(0,i.jsx)(Z.rU,{to:(0,en.$U)(d,"/asset-groups/".concat(u.groupName)),children:(0,i.jsxs)(m.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)(H.JO,{color:v.w.Gray400,name:"asset_group"}),u.groupName]})}):(0,i.jsx)(x.YS,{color:v.w.Gray400,children:"Asset not found"}):(0,i.jsx)(y.$,{purpose:"body-text"})}),(0,i.jsx)(ee.E5,{children:(0,i.jsxs)(Z.rU,{to:(0,es.p)(r,{view:"auto-materialize-history",evaluation:"".concat(o)}),children:[a," materialization",1===a?"":"s"," requested"]})})]})})},el=(0,M.ZP)(m.x).withConfig({componentId:"sc-1253605f-0"})(AutomaterializationTickDetailDialog_templateObject(),eo),ec=(0,N.Ps)(_templateObject1()),eu=n(46253),ed=n(5063);function AutomaterializeRunHistoryTable_templateObject(){var e=(0,z._)(["\n  position: relative;\n  > *:nth-child(2) {\n    position: absolute;\n    right: 0;\n    top: 0;\n  }\n"]);return AutomaterializeRunHistoryTable_templateObject=function(){return e},e}var AutomaterializeRunHistoryTable=function(e){var t,n=e.setTableView,r=(0,q.l)({nextCursorForResult:function(e){var t;if("Runs"===e.pipelineRunsOrError.__typename)return null===(t=e.pipelineRunsOrError.results[14])||void 0===t?void 0:t.id},getResultArray:function(e){return e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[]},variables:{filter:{tags:[{key:"dagster/auto_materialize",value:"true"}]}},query:ed.RUNS_ROOT_QUERY,pageSize:15}),s=r.queryResult,o=r.paginationProps;(0,k.C4)(s,15e3);var a=null===(t=s.data||s.previousData)||void 0===t?void 0:t.pipelineRunsOrError;return(0,i.jsxs)(m.x,{children:[(0,i.jsxs)(eh,{children:[(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},margin:{top:32},border:"top",children:(0,i.jsx)(L.h,{activeItems:new Set(["runs"]),buttons:[{id:"evaluations",label:"Evaluations"},{id:"runs",label:"Runs"}],onClick:function(e){n(e)}})}),(0,i.jsx)(eu.AL,{runs:(null==a?void 0:a.__typename)==="Runs"?a.results:[]})]}),(0,i.jsx)("div",{style:{paddingBottom:"16px"},children:(0,i.jsx)(D.pI,(0,l._)({},o))})]})},eh=M.ZP.div.withConfig({componentId:"sc-940b9edd-0"})(AutomaterializeRunHistoryTable_templateObject()),AutomaterializationRoot=function(){var e,t,fetchData=function(){z({variables:V})};(0,O.Px)();var n=(0,R.dx)(),r=(0,w.p)(),o=(0,S.WB)().permissions,E=(void 0===o?{}:o).canToggleAutoMaterialize,I=(0,c._)((0,h.t)(F),2),z=I[0],N=I[1],P=(0,c._)(s.useState(!1),2),B=P[0],L=P[1],U=(0,c._)(s.useState(void 0),2),D=U[0],M=U[1],K=(0,c._)(s.useState(void 0),2),$=K[0],q=K[1],V=s.useMemo(function(){return $||D?{afterTimestamp:null==$?void 0:$[0],beforeTimestamp:null==$?void 0:$[1],statuses:D}:{afterTimestamp:(Date.now()-12e5)/1e3}},[D,$]);(0,s.useLayoutEffect)(fetchData,[V]),(0,k.C4)(N,2e3,!B&&!$&&!D,fetchData);for(var J=(0,c._)(s.useState(null),2),G=J[0],W=J[1],H=(0,c._)((0,T.q)(s.useMemo(function(){return{queryKey:"view",decode:function(e){return"runs"===e.view?"runs":"evaluations"},encode:function(e){return{view:e,cursor:void 0,statuses:void 0}}}},[])),2),Q=H[0],Z=H[1],X=null!==(t=N.data)&&void 0!==t?t:N.previousData,Y=X?X.autoMaterializeTicks.map(function(e){return"".concat(e.id,":").concat(e.status)}):[];Y.length<100;)Y.push("");var ee=s.useMemo(function(){var e,t=null==X?void 0:X.autoMaterializeTicks;return null!==(e=null==t?void 0:t.map(function(e,n){if(0!==n&&!(0,C.S)(e)&&!e.endTimestamp){var r=(0,l._)({},e);return r.endTimestamp=t[n-1].timestamp,r.status=_.izS.FAILURE,r}return e}))&&void 0!==e?e:[]},(0,u._)(Y.slice(0,100))),et=s.useCallback(function(e){L(!!e)},[L]);return(0,i.jsxs)(p.T,{children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"amp"})}),(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},flex:{direction:"column",gap:12},background:v.w.Gray50,children:(0,i.jsx)(g.b,{intent:"info",title:"[Experimental] Dagster can automatically materialize assets when criteria are met.",description:(0,i.jsxs)(i.Fragment,{children:["Auto-materialization enables a declarative approach to asset scheduling – instead of defining imperative workflows to materialize your assets, you just describe the conditions under which they should be materialized."," ",(0,i.jsx)("a",{href:"https://docs.dagster.io/concepts/assets/asset-auto-execution",target:"_blank",rel:"noreferrer",children:"Learn more about auto-materialization here"}),"."]})})}),(0,i.jsx)(j.i,{children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Running"}),(0,i.jsx)("td",{children:n.loading?(0,i.jsx)(y.$,{purpose:"body-text"}):(0,i.jsx)(b.X,{format:"switch",checked:!n.paused,disabled:!E,onChange:(e=(0,a._)(function(e){var t;return(0,d.Jh)(this,function(i){switch(i.label){case 0:if(t=e.target.checked)return[3,2];return[4,r({title:"Pause Auto-materializing?",description:"Pausing Auto-materializing will prevent new materializations triggered by an Auto-materializing policy."})];case 1:i.sent(),i.label=2;case 2:return n.setPaused(!t),[2]}})}),function(t){return e.apply(this,arguments)})})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Evaluation frequency"}),(0,i.jsx)("td",{children:"~30s"})]})]})}),(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:(0,i.jsx)(x.Tj,{children:"Evaluation timeline"})}),X?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.p,{ticks:ee,onHoverTick:et,onSelectTick:W,exactRange:$,timeRange:12e5,tickGrid:3e5,timeAfter:18e4}),(0,i.jsx)(ea,{tick:G,isOpen:!!G,close:function(){W(null)}},null==G?void 0:G.id),"evaluations"===Q?(0,i.jsx)(AutomaterializationEvaluationHistoryTable,{setSelectedTick:W,setTableView:Z,setParentStatuses:M,setTimerange:q}):(0,i.jsx)(AutomaterializeRunHistoryTable,{setTableView:Z})]}):(0,i.jsx)(m.x,{padding:{vertical:48},children:(0,i.jsx)(y.$,{purpose:"page"})})]})},ep=n(92364),ef=n(56266),ex=n(28252),em=n(62311),ev=n(77376),eg=n(16292),ej=n(31761),ey=n(94611);function InstanceBackfills_templateObject(){var e=(0,z._)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"]);return InstanceBackfills_templateObject=function(){return e},e}function InstanceBackfills_templateObject1(){var e=(0,z._)(["\n  query InstanceBackfillsQuery($status: BulkActionStatus, $cursor: String, $limit: Int) {\n    partitionBackfillsOrError(status: $status, cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          id\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return InstanceBackfills_templateObject1=function(){return e},e}var labelForBackfillStatus=function(e){switch(e){case _.Jv3.CANCELED:return"Canceled";case _.Jv3.CANCELING:return"Canceling";case _.Jv3.COMPLETED:return"Completed";case _.Jv3.FAILED:return"Failed";case _.Jv3.REQUESTED:return"In progress"}},eb=Object.keys(_.Jv3).map(function(e){var t=labelForBackfillStatus(e);return{label:t,value:e,match:[e,t]}}),InstanceBackfills=function(){(0,O.Px)(),(0,ex.j)("Overview | Backfills");var e=(0,W.a)(ew),t=(0,eg.im)({name:"Status",icon:"status",allValues:eb,allowMultipleSelections:!1,closeOnSelect:!0,renderLabel:function(e){var t=e.value;return(0,i.jsx)("div",{children:labelForBackfillStatus(t)})},getStringValue:function(e){return labelForBackfillStatus(e)}}),n=t.state,r=(0,ev.m)({filters:[t]}),s=r.button,o=r.activeFiltersJsx,a=(0,q.l)({query:eS,variables:{status:n.size>0?Array.from(n)[0]:void 0},pageSize:10,nextCursorForResult:function(e){var t;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(t=e.partitionBackfillsOrError.results[9])||void 0===t?void 0:t.id:void 0},getResultArray:function(e){return(null==e?void 0:e.partitionBackfillsOrError.__typename)==="PartitionBackfills"?e.partitionBackfillsOrError.results:[]}}),c=a.queryResult,u=a.paginationProps,d=(0,k.C4)(c,k.dT),h=c.loading,g=c.data;return(0,i.jsxs)(p.T,{children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"backfills",refreshState:d})}),(0,i.jsx)(m.x,{padding:{vertical:12,horizontal:20},children:(0,i.jsxs)(m.x,{flex:{direction:"column",gap:8},children:[(0,i.jsx)("div",{children:s}),o]})}),function(){if(h&&!g)return(0,i.jsx)(m.x,{padding:{vertical:64},flex:{direction:"column",alignItems:"center"},children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,i.jsx)(y.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:v.w.Gray600},children:"Loading backfills…"})]})});var t,r=null==g?void 0:g.partitionBackfillsOrError;if((null==r?void 0:r.__typename)==="PythonError")return(0,i.jsx)(ef.T9,{error:r});if(!r||!(null==r?void 0:r.results.length))return n.size>0?(0,i.jsx)(m.x,{padding:{vertical:64},children:(0,i.jsx)(ep.t,{icon:"no-results",title:"No matching backfills",description:"No backfills were found for this filter."})}):(0,i.jsx)(m.x,{padding:{vertical:64},children:(0,i.jsx)(ep.t,{icon:"no-results",title:"No backfills found",description:"This instance does not have any backfill jobs."})});var s=((null===(t=e.data)||void 0===t?void 0:t.instance.daemonHealth.allDaemonStatuses)||[]).filter(function(e){return"BACKFILL"===e.daemonType}).map(function(e){return e.required&&e.healthy}),o=s.length&&s.every(function(e){return e});return(0,i.jsxs)("div",{children:[o?null:(0,i.jsx)(m.x,{padding:{horizontal:24,vertical:16},children:(0,i.jsx)(em.B1,{})}),(0,i.jsx)(ey.G,{backfills:r.results.slice(0,10),refetch:c.refetch}),r.results.length>0?(0,i.jsx)(m.x,{margin:{top:16},children:(0,i.jsx)(D.b$,(0,l._)({},u))}):null]})}()]})},ew=(0,N.Ps)(InstanceBackfills_templateObject(),ej.O),eS=(0,N.Ps)(InstanceBackfills_templateObject1(),P.B,ey.b),ek=n(56675),eO=n(57830),e_=n(28879),eT=n.n(e_),eA=n(64989),eC=n.n(eA),eE=n(77491),eR=n.n(eE),eI=n(60130),ez=n(49313),eN=n(68052),eP=n(1813),eF=n(68651),eB=n(67690);function BackfillPage_templateObject(){var e=(0,z._)(["\n  color: ",";\n  font-size: 12px;\n  line-height: 16px;\n"]);return BackfillPage_templateObject=function(){return e},e}function BackfillPage_templateObject1(){var e=(0,z._)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...PartitionBackfillFragment\n      ...PythonErrorFragment\n      ... on BackfillNotFoundError {\n        message\n      }\n    }\n  }\n\n  fragment PartitionBackfillFragment on PartitionBackfill {\n    id\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    ...BackfillActionsBackfillFragment\n\n    error {\n      ...PythonErrorFragment\n    }\n    assetBackfillData {\n      rootTargetedPartitions {\n        partitionKeys\n        ranges {\n          start\n          end\n        }\n      }\n      assetBackfillStatuses {\n        ... on AssetPartitionsStatusCounts {\n          assetKey {\n            path\n          }\n          numPartitionsTargeted\n          numPartitionsInProgress\n          numPartitionsMaterialized\n          numPartitionsFailed\n        }\n        ... on UnpartitionedAssetStatus {\n          assetKey {\n            path\n          }\n          inProgress\n          materialized\n          failed\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return BackfillPage_templateObject1=function(){return e},e}function _templateObject2(){var e=(0,z._)(["\n  query BackfillPartitionsForAssetKey($backfillId: String!, $assetKey: AssetKeyInput!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ... on PartitionBackfill {\n        id\n        partitionsTargetedForAssetKey(assetKey: $assetKey) {\n          partitionKeys\n          ranges {\n            start\n            end\n          }\n        }\n      }\n    }\n  }\n"]);return _templateObject2=function(){return e},e}eT().extend(eC()),eT().extend(eR());var BackfillPage=function(){var e=(0,ek.x)(),t=(0,o.k6)(),n=(0,o.UO)().backfillId;(0,O.Px)(),(0,ex.j)("Backfill | ".concat(n));var r=(0,W.a)(eU,{variables:{backfillId:n}}),s=r.data,l=(null==s?void 0:s.partitionBackfillOrError.__typename)==="PartitionBackfill"?s.partitionBackfillOrError:null,c=!l||[_.Jv3.REQUESTED,_.Jv3.CANCELING].includes(l.status),u=(0,k.C4)(r,1e4,c);return(0,i.jsxs)(p.T,{children:[(0,i.jsx)(f.m,{title:(0,i.jsxs)(x.X6,{children:[(0,i.jsx)(Z.rU,{to:"/overview/backfills",style:{color:v.w.Gray700},children:"Backfills"})," / ",n]}),right:(0,i.jsxs)(m.x,{flex:{gap:12,alignItems:"center"},children:[c?(0,i.jsx)(k.xi,{refreshState:u}):null,l?(0,i.jsx)(eP.WH,{backfill:l,refetch:r.refetch,canCancelRuns:l.status===_.Jv3.REQUESTED}):null]})}),function(){if(!s||!s.partitionBackfillOrError)return(0,i.jsx)(m.x,{padding:64,"data-testid":(0,eN.N)("page-loading-indicator"),children:(0,i.jsx)(y.$,{purpose:"page"})});if("PythonError"===s.partitionBackfillOrError.__typename)return(0,i.jsx)(ef.T9,{error:s.partitionBackfillOrError});if("BackfillNotFoundError"===s.partitionBackfillOrError.__typename)return(0,i.jsx)(ep.t,{icon:"no-results",title:s.partitionBackfillOrError.message});var r,o,l,c=s.partitionBackfillOrError;function getRunsUrl(e){var t=[{token:"tag",value:"dagster/backfill=".concat(n)}];switch(e){case"inProgress":t.push({token:"status",value:_.VOA.STARTED},{token:"status",value:_.VOA.QUEUED},{token:"status",value:_.VOA.STARTING},{token:"status",value:_.VOA.CANCELING},{token:"status",value:_.VOA.NOT_STARTED});break;case"complete":t.push({token:"status",value:_.VOA.SUCCESS});break;case"failed":t.push({token:"status",value:_.VOA.FAILURE}),t.push({token:"status",value:_.VOA.CANCELED})}return(0,ez.it)(t)}var u=(r=(0,a._)(function(r,i){var s,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(s={},!i)return[3,2];return[4,e.query({query:eD,variables:{backfillId:n,assetKey:(0,eI.W1)(r)}})];case 1:(l="PartitionBackfill"===(a=c.sent()).data.partitionBackfillOrError.__typename?a.data.partitionBackfillOrError.partitionsTargetedForAssetKey:null)&&(null===(o=l.ranges)||void 0===o?void 0:o.length)&&(s={default_range:l.ranges.map(function(e){return"[".concat(e.start,"...").concat(e.end,"]")}).join(",")}),c.label=2;case 2:return[2,t.push((0,es.p)(r,s))]}})}),function(e,t){return r.apply(this,arguments)});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},"data-testid":(0,eN.N)("backfill-page-details"),children:[(0,i.jsx)(Detail,{label:"Created",detail:(0,i.jsx)(K.E,{timestamp:{ms:Number(1e3*c.timestamp)},timeFormat:{showSeconds:!0,showTimezone:!1}})}),(0,i.jsx)(Detail,{label:"Duration",detail:(0,i.jsx)(Duration,{start:1e3*c.timestamp,end:c.endTimestamp?1e3*c.endTimestamp:null})}),(0,i.jsx)(Detail,{label:"Partition selection",detail:(0,i.jsx)(eB.b,{targetPartitionCount:c.numPartitions||0,targetPartitions:null===(o=c.assetBackfillData)||void 0===o?void 0:o.rootTargetedPartitions})}),(0,i.jsx)(Detail,{label:"Status",detail:(0,i.jsx)(eF.w,{backfill:c})})]}),(0,i.jsxs)(j.i,{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:"50%"},children:"Asset name"}),(0,i.jsx)("th",{children:(0,i.jsx)(Z.rU,{to:getRunsUrl("targeted"),children:"Partitions targeted"})}),(0,i.jsx)("th",{children:(0,i.jsx)(Z.rU,{to:getRunsUrl("inProgress"),children:"In progress"})}),(0,i.jsx)("th",{children:(0,i.jsx)(Z.rU,{to:getRunsUrl("complete"),children:"Completed"})}),(0,i.jsx)("th",{children:(0,i.jsx)(Z.rU,{to:getRunsUrl("failed"),children:"Failed"})})]})}),(0,i.jsx)("tbody",{children:null===(l=c.assetBackfillData)||void 0===l?void 0:l.assetBackfillStatuses.map(function(e){var t,n,r,s;return"AssetPartitionsStatusCounts"===e.__typename?(t=e.numPartitionsTargeted,n=e.numPartitionsInProgress,r=e.numPartitionsMaterialized,s=e.numPartitionsFailed):(t=1,s=e.failed?1:0,n=e.inProgress?1:0,r=e.materialized?1:0),(0,i.jsxs)("tr",{"data-testid":(0,eN.N)("backfill-asset-row-".concat((0,X.Je)(e.assetKey))),children:[(0,i.jsx)("td",{children:(0,i.jsxs)(m.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,i.jsx)("div",{children:(0,i.jsx)(U.Z,{onClick:function(){return u(e.assetKey,"AssetPartitionsStatusCounts"===e.__typename)},children:e.assetKey.path.join("/")})}),(0,i.jsx)("div",{children:(0,i.jsx)(StatusBar,{targeted:t,inProgress:n,completed:r,failed:s})})]})}),"AssetPartitionsStatusCounts"===e.__typename?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{children:t}),(0,i.jsx)("td",{children:n}),(0,i.jsx)("td",{children:r}),(0,i.jsx)("td",{children:s})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{children:"-"}),(0,i.jsx)("td",{children:n?(0,i.jsx)(eO.V,{icon:"spinner",intent:"primary",children:"In progress"}):"-"}),(0,i.jsx)("td",{children:r?(0,i.jsx)(eO.V,{intent:"success",children:"Completed"}):"-"}),(0,i.jsx)("td",{children:s?(0,i.jsx)(eO.V,{intent:"danger",children:"Failed"}):"-"})]})]},(0,X.Je)(e.assetKey))})})]})]})}()]})},Detail=function(e){var t=e.label,n=e.detail;return(0,i.jsxs)(m.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,i.jsx)(eL,{children:t}),(0,i.jsx)("div",{children:n})]})};function StatusBar(e){var t=e.targeted,n=e.inProgress,r=e.completed,s=e.failed;return(0,i.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:v.w.Gray100,display:"grid",gridTemplateColumns:"".concat(100*r/t,"% ").concat(100*s/t,"% ").concat(100*n/t,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,i.jsx)("div",{style:{background:v.w.Green500}}),(0,i.jsx)("div",{style:{background:v.w.Red500}}),(0,i.jsx)("div",{style:{background:v.w.Blue200}})]})}var eL=M.ZP.div.withConfig({componentId:"sc-f3b8d45d-0"})(BackfillPage_templateObject(),v.w.Gray700),Duration=function(e){var t=e.start,n=e.end,r=(0,c._)(s.useReducer(function(e,t){return e+1},0),2),o=(r[0],r[1]);s.useEffect(function(){if(!n){var e=setInterval(o,6e4);return function(){return clearInterval(e)}}},[t,n]);var a=n?n-t:Date.now()-t;return(0,i.jsx)("span",{children:formatDuration(a)})},eU=(0,N.Ps)(BackfillPage_templateObject1(),P.B,eP.V2),eD=(0,N.Ps)(_templateObject2()),formatDuration=function(e){var t=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),r=Math.floor(e/864e5),i="";return r>0?i+="".concat(r,"d ")+"".concat(n,"h"):n>0?i+="".concat(n,"h ")+"".concat(t,"m"):t>0&&(i+="".concat(t,"m ")+"".concat(Math.floor(e/1e3%60),"s")),i.trim()},eM=n(9001),eK=n(15282),e$=n(46928),eq=n(6692),eV=n(34822),eJ=n(21106),eG=n(17276),eW=n(44678),eH=n(69643),eQ=n(99322),eZ=n(58885),eX=n(65885),eY=n(63386);function OverviewAssetsRoot_templateObject(){var e=(0,z._)(["\n  display: grid;\n  grid-template-columns: ",";\n  height: 100%;\n  > * {\n    vertical-align: middle;\n  }\n"]);return OverviewAssetsRoot_templateObject=function(){return e},e}function OverviewAssetsRoot_templateObject1(){var e=(0,z._)(["\n  font-size: 12px;\n  pointer-events: none;\n  a {\n    color: ",";\n    pointer-events: none;\n    max-width: ",";\n  }\n"]);return OverviewAssetsRoot_templateObject1=function(){return e},e}function OverviewAssetsRoot_templateObject2(){var e=(0,z._)(["\n  cursor: pointer;\n  &:hover {\n    font-weight: 600;\n  }\n"]);return OverviewAssetsRoot_templateObject2=function(){return e},e}function _templateObject3(){var e=(0,z._)(["\n  &:hover {\n    text-decoration: none;\n  }\n"]);return _templateObject3=function(){return e},e}var OverviewAssetsRoot=function(e){var t,n,r,o=e.Header,a=e.TabButton;(0,O.Px)(),(0,ex.j)("Overview | Assets");var l=(0,W.a)(eX.C1,{notifyOnNetworkStatusChange:!0}),u=(0,k.C4)(l,k.dT),d=s.useMemo(function(){var e,t,n;return(null===(e=l.data)||void 0===e?void 0:e.assetsOrError.__typename)==="AssetConnection"?(t=l.data.assetsOrError.nodes,n={},t.forEach(function(e){if(e.definition){var t=e.definition.groupName,r=e.definition.repository.name,i="".concat(t,"||").concat(r),s=n[i]||{groupName:t,repositoryName:r,assets:[]};s.assets.push(e),n[i]=s}}),Object.values(n)):[]},[null===(r=l.data)||void 0===r?void 0:r.assetsOrError]),h=(0,c._)((0,T.q)({queryKey:"q",decode:function(e){return e.searchQuery?JSON.parse(e.searchQuery):""},encode:function(e){return{searchQuery:e?JSON.stringify(e):void 0}}}),2),p=h[0],f=h[1],x=s.useMemo(function(){return""===p?d:d.filter(function(e){return(e.groupName||e1).toLowerCase().includes(p.toLowerCase())||e.repositoryName.toLowerCase().includes(p.toLowerCase())})},[d,p]),v=s.useRef(null),g=(0,Q.useVirtualizer)({count:x.length,getScrollElement:function(){return v.current},estimateSize:function(){return 82},overscan:5}),j=g.getTotalSize(),b=g.getVirtualItems();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1},children:[(0,i.jsx)(o,{refreshState:u}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",gap:12,grow:0},children:[(0,i.jsx)(a,{selected:"assets"}),(0,i.jsx)(eV.oi,{value:p,onChange:function(e){f(e.target.value)},placeholder:"Filter asset groups…"})]})]}),(n=null===(t=l.data)||void 0===t?void 0:t.assetsOrError,!l.data&&l.loading?(0,i.jsx)(m.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,i.jsx)(y.$,{purpose:"page"})}):(null==n?void 0:n.__typename)==="PythonError"?(0,i.jsx)(m.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,i.jsx)(ef.T9,{error:n})}):(0,i.jsx)(m.x,{flex:{direction:"column"},style:{overflow:"hidden"},children:(0,i.jsxs)(ee.W2,{ref:v,children:[(0,i.jsx)(VirtualHeaderRow,{}),(0,i.jsx)(ee.Nh,{$totalHeight:j,children:b.map(function(e){var t=e.index,n=e.key,r=e.size,s=e.start,o=x[t];return(0,i.jsx)(VirtualRow,{start:s,height:r,group:o},n)})})]})}))]})},e0="5fr 1fr 1fr 1fr 1fr";function VirtualHeaderRow(){return(0,i.jsxs)(m.x,{border:"top-and-bottom",style:{display:"grid",gridTemplateColumns:e0,height:"32px",fontSize:"12px",color:v.w.Gray600,position:"sticky",top:0,zIndex:1,background:v.w.White},children:[(0,i.jsx)(ee.qN,{children:"Group name"}),(0,i.jsx)(ee.qN,{children:"Missing"}),(0,i.jsx)(ee.qN,{children:"Failed/Overdue"}),(0,i.jsx)(ee.qN,{children:"In progress"}),(0,i.jsx)(ee.qN,{children:"Materialized"})]})}var e1="Ungrouped Assets";function VirtualRow(e){var t,n,r=e.height,o=e.start,a=e.group,c=s.useMemo(function(){return a.assets.map(function(e){return{path:e.key.path}})},[a.assets]),u=(0,eH.YP)(c).liveDataByNode,d=s.useMemo(function(){var e={successful:[],failed:[],inprogress:[],missing:[],loading:!1};return Object.keys(u).length?Object.keys(u).forEach(function(t){var n=u[t],r=a.assets.find(function(e){return(0,X.Je)(e.key)===t});if(!(null==r?void 0:r.definition)){console.warn("Expected a definition for asset with key",t);return}var i=(0,eQ.D5)({assetKey:r.key,definition:r.definition,liveData:n,expanded:!0});switch(i.case){case eQ.KB.LOADING:e.loading=!0;break;case eQ.KB.SOURCE_OBSERVING:e.inprogress.push({asset:r,status:i});break;case eQ.KB.SOURCE_OBSERVED:e.successful.push({asset:r,status:i});break;case eQ.KB.SOURCE_NEVER_OBSERVED:case eQ.KB.SOURCE_NO_STATE:e.missing.push({asset:r,status:i});break;case eQ.KB.MATERIALIZING:e.inprogress.push({asset:r,status:i});break;case eQ.KB.LATE_OR_FAILED:e.failed.push({asset:r,status:i});break;case eQ.KB.NEVER_MATERIALIZED:e.missing.push({asset:r,status:i});break;case eQ.KB.MATERIALIZED:e.successful.push({asset:r,status:i});break;case eQ.KB.PARTITIONS_FAILED:e.failed.push({asset:r,status:i});break;case eQ.KB.PARTITIONS_MISSING:e.missing.push({asset:r,status:i});break;case eQ.KB.PARTITIONS_MATERIALIZED:e.successful.push({asset:r,status:i})}}):e.loading=!0,e},[u,a.assets]),h=null===(n=a.assets.find(function(e){var t;return null===(t=e.definition)||void 0===t?void 0:t.repository}))||void 0===n?void 0:null===(t=n.definition)||void 0===t?void 0:t.repository,p=(0,et.kQ)((null==h?void 0:h.name)||"",(null==h?void 0:h.location.name)||""),f=(0,eJ.S)(),x=f.containerProps,g=f.viewport,j=c.length!==Object.keys(u).length,b=j?"":"0";return(0,i.jsx)(ee.X2,{$height:r,$start:o,children:(0,i.jsxs)(e2,{border:"bottom",children:[(0,i.jsx)(Cell,{children:(0,i.jsxs)(m.x,{flex:{direction:"row",justifyContent:"space-between",grow:1},children:[(0,i.jsxs)(m.x,{flex:{direction:"column",gap:2,grow:1},children:[(0,i.jsxs)(m.x,{flex:{direction:"row",gap:8},children:[(0,i.jsx)(H.JO,{name:"asset_group"}),a.groupName?(0,i.jsx)(Z.rU,{style:{fontWeight:700},to:(0,en.$U)(p,"/asset-groups/".concat(a.groupName)),children:a.groupName}):e1]}),(0,i.jsx)("div",(0,eq._)((0,l._)({},x),{children:(0,i.jsx)(e6,{maxWidth:g.width,children:(0,i.jsx)(eY.b,{repoAddress:p,showRefresh:!1})})}))]}),(0,i.jsx)(m.x,{flex:{direction:"column",justifyContent:"center"},children:j?(0,i.jsx)(y.$,{purpose:"body-text"}):null})]})}),(0,i.jsx)(Cell,{children:d.missing.length?(0,i.jsx)(SelectOnHover,{assets:d.missing,getCount:function(e){var t=e.status;return t.case===eQ.KB.PARTITIONS_MISSING&&t.numMissing||0},adjective:"missing",children:(0,i.jsx)(eO.V,{intent:"none",children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,i.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(v.w.Gray500),borderRadius:"50%"}}),d.missing.length]})})}):b}),(0,i.jsx)(Cell,{children:d.failed.length?(0,i.jsx)(SelectOnHover,{assets:d.failed,getCount:function(e){var t=e.status;return t.case===eQ.KB.PARTITIONS_FAILED&&t.numFailed||0},adjective:"failed",children:(0,i.jsx)(eO.V,{intent:"danger",children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,i.jsx)("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"10px solid red",display:"inline-block"}}),d.failed.length]})})}):b}),(0,i.jsx)(Cell,{children:d.inprogress.length?(0,i.jsx)(SelectOnHover,{assets:d.inprogress,getCount:function(e){var t=e.status;return t.case===eQ.KB.MATERIALIZING&&t.numMaterializing||0},adjective:"materializing",children:(0,i.jsx)(eO.V,{intent:"primary",icon:"spinner",children:d.inprogress.length})}):b}),(0,i.jsx)(Cell,{children:d.successful.length?(0,i.jsx)(SelectOnHover,{assets:d.successful,getCount:function(e){var t=e.status;return t.case===eQ.KB.PARTITIONS_MATERIALIZED&&t.numMaterialized||0},adjective:"materialized",children:(0,i.jsx)(eO.V,{intent:"success",children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,i.jsx)("div",{style:{backgroundColor:v.w.Green500,width:"10px",height:"10px",borderRadius:"50%"}}),d.successful.length]})})}):b})]})})}var e2=(0,M.ZP)(m.x).withConfig({componentId:"sc-101873ae-0"})(OverviewAssetsRoot_templateObject(),e0),Cell=function(e){var t=e.children;return(0,i.jsx)(ee.E5,{style:{color:v.w.Gray900},children:(0,i.jsx)(m.x,{flex:{direction:"row",alignItems:"center",grow:1},children:t})})},e6=M.ZP.div.withConfig({componentId:"sc-101873ae-1"})(OverviewAssetsRoot_templateObject1(),v.w.Gray600,function(e){var t=e.maxWidth;return t?"unset":"".concat(t,"px")});function SelectOnHover(e){var t=e.assets,n=e.children,r=e.getCount,s=e.adjective;return(0,i.jsx)(e3,{children:(0,i.jsx)(eG.P,{items:t,itemPredicate:function(e,t){return(0,X.ll)(t.asset.key).toLocaleLowerCase().includes(e.toLocaleLowerCase())},itemRenderer:function(e){var t=r(e);return(0,i.jsx)(e4,{to:(0,es.p)(e.asset.key),target:"_blank",children:(0,i.jsx)(eW.sN,{text:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,i.jsx)("div",{style:{paddingLeft:"4px"},children:(0,i.jsx)(H.JO,{name:"asset"})}),(0,i.jsx)("div",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,X.ll)(e.asset.key)}),t&&t>0?(0,i.jsxs)(x.YS,{style:{color:v.w.Gray700},children:[(0,eZ._e)(t)," ",s]}):null]})},(0,X.ll)(e.asset.key))})},onItemSelect:function(){},children:n})})}var e3=M.ZP.div.withConfig({componentId:"sc-101873ae-2"})(OverviewAssetsRoot_templateObject2()),e4=(0,M.ZP)(Z.rU).withConfig({componentId:"sc-101873ae-3"})(_templateObject3()),e5=n(64595),e8=n(10952),e9=n(75690),e7=n(51969),RepoFilterButton=function(){var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.toggleVisible,o=(0,c._)(s.useState(!1),2),a=o[0],l=o[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e8.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:a,style:{width:"auto"},onClose:function(){return l(!1)},children:[(0,i.jsx)(e8.fK,{icon:"repo",label:"Filter code locations"}),(0,i.jsx)(e9.e,{options:t,onBrowse:function(){return l(!1)},onToggle:r,selected:n}),(0,i.jsx)(e8.cN,{children:(0,i.jsx)(m.x,{padding:{top:8},children:(0,i.jsx)(eM.zx,{intent:"none",onClick:function(){return l(!1)},children:"Done"})})})]}),(0,i.jsx)(eM.zx,{intent:"none",icon:(0,i.jsx)(H.JO,{name:"folder"}),rightIcon:(0,i.jsx)(H.JO,{name:"expand_more"}),onClick:function(){return l(!0)},children:"".concat(n.length," of ").concat(t.length)})]})},te=n(65435),useHourWindow=function(e){var t=s.useCallback(function(t){switch(t){case"1":case"6":case"12":case"24":return t;default:return e}},[e]),n=(0,c._)((0,eK.U)("dagster.run-timeline-hour-window",t),2),r=n[0],i=n[1],o=s.useCallback(function(t){i(t||e)},[e,i]);return s.useMemo(function(){return[r,o]},[r,o])};function NextTick_templateObject(){var e=(0,z._)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]);return NextTick_templateObject=function(){return e},e}var tt=(0,N.Ps)(NextTick_templateObject()),tn=n(44254),tr=n(6315),ti=n(38917),ts=n(16413);function useRunsForTimeline_templateObject(){var e=(0,z._)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return useRunsForTimeline_templateObject=function(){return e},e}var useRunsForTimeline=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,c._)(e,2),r=n[0],i=n[1],o=r/1e3,a=i/1e3,d=(0,W.a)(to,{notifyOnNetworkStatusChange:!0,fetchPolicy:"no-cache",variables:{inProgressFilter:(0,eq._)((0,l._)({},t),{statuses:[_.VOA.CANCELING,_.VOA.STARTED],createdBefore:a}),terminatedFilter:(0,eq._)((0,l._)({},t),{statuses:Array.from(tr.cv),createdBefore:a,updatedAfter:o}),tickCursor:o,ticksUntil:a}}),h=d.data,p=d.previousData,f=d.loading&&!h,x=h||p||{},m=x.unterminated,v=x.terminated,g=x.workspaceOrError,j=s.useMemo(function(){var e={},t=Date.now();return(0,u._)((null==m?void 0:m.__typename)==="Runs"?m.results:[]).concat((0,u._)((null==v?void 0:v.__typename)==="Runs"?v.results:[])).forEach(function(n){if(n.startTime&&n.repositoryOrigin&&(0,ts.a)({start:r,end:i},{start:1e3*n.startTime,end:n.endTime?1e3*n.endTime:t})){var s=makeJobKey({name:n.repositoryOrigin.repositoryName,location:n.repositoryOrigin.repositoryLocationName},n.pipelineName);e[s]=(0,u._)(e[s]||[]).concat([{id:n.id,status:n.status,startTime:1e3*n.startTime,endTime:n.endTime?1e3*n.endTime:t}])}}),e},[i,m,v,r]),y=s.useMemo(function(){if(!g||"Workspace"!==g.__typename)return[];var e=[],t=!0,n=!1,s=void 0;try{for(var o,a=g.locationEntries[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)!function(){var t=o.value;if("WorkspaceLocationEntry"===t.__typename&&(null===(c=t.locationOrLoadError)||void 0===c?void 0:c.__typename)==="RepositoryLocation"){var n=Date.now(),s=!0,a=!1,l=void 0;try{for(var c,d,h=t.locationOrLoadError.repositories[Symbol.iterator]();!(s=(d=h.next()).done);s=!0)!function(){var s=d.value,o=(0,et.kQ)(s.name,t.locationOrLoadError.name),a=!0,l=!1,c=void 0;try{for(var h,p=s.pipelines[Symbol.iterator]();!(a=(h=p.next()).done);a=!0)!function(){var t=h.value,a=(s.schedules||[]).filter(function(e){return e.pipelineName===t.name}),l=[],c=!0,d=!1,p=void 0;try{for(var f,x=a[Symbol.iterator]();!(c=(f=x.next()).done);c=!0)!function(){var e=f.value;e.scheduleState.status===_.ynu.RUNNING&&e.futureTicks.results.forEach(function(t){var s=t.timestamp,o=1e3*s;o>n&&(0,ts.a)({start:r,end:i},{start:o,end:o})&&l.push({id:"".concat(e.pipelineName,"-future-run-").concat(s),status:"SCHEDULED",startTime:o,endTime:o+5e3})})}()}catch(e){d=!0,p=e}finally{try{c||null==x.return||x.return()}finally{if(d)throw p}}var m=(0,X.pv)(t.name),v=makeJobKey(o,t.name),g=m?"Ad hoc materializations":t.name,y=j[v]||[];if(l.length||y.length){var b=(0,u._)(y).concat((0,u._)(l));if(m){var w,S=e.find(function(e){return"asset"===e.jobType&&e.repoAddress===o});if(S)return(w=S.runs).push.apply(w,(0,u._)(b))}e.push({key:v,jobName:g,jobType:m?"asset":"job",repoAddress:o,path:(0,en.jT)({repoName:o.name,repoLocation:o.location,pipelineName:t.name,isJob:t.isJob}),runs:(0,u._)(y).concat((0,u._)(l))})}}()}catch(e){l=!0,c=e}finally{try{a||null==p.return||p.return()}finally{if(l)throw c}}}()}catch(e){a=!0,l=e}finally{try{s||null==h.return||h.return()}finally{if(a)throw l}}}}()}catch(e){n=!0,s=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw s}}var c=e.reduce(function(e,t){var n,r=t.runs.map(function(e){return e.startTime});return(0,eq._)((0,l._)({},e),(0,B._)({},t.key,(n=Math).min.apply(n,(0,u._)(r))))},{});return e.sort(function(e,t){return c[e.key]-c[t.key]})},[g,j,r,i]);return s.useMemo(function(){return{jobs:y,initialLoading:f,queryData:d}},[f,y,d])},makeJobKey=function(e,t){return"".concat(t,"-").concat((0,tn.Uz)(e))},to=(0,N.Ps)(useRunsForTimeline_templateObject(),ti.$X,tt),hourWindowToOffset=function(e){switch(e){case"1":return 36e5;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},OverviewTimelineRoot=function(e){var t=e.Header,n=e.TabButton;(0,O.Px)(),(0,ex.j)("Overview | Timeline");var r=s.useContext(e7.C5),o=r.allRepos,a=r.visibleRepos,l=(0,c._)(useHourWindow("12"),2),u=l[0],d=l[1],h=(0,c._)(s.useState(function(){return Date.now()}),2),p=h[0],f=h[1],x=(0,c._)(s.useState(function(){return 0}),2),v=x[0],g=x[1],j=(0,c._)((0,T.q)({queryKey:"search",defaults:{search:""}}),2),y=j[0],b=j[1];s.useEffect(function(){f(Date.now());var e=setInterval(function(){f(Date.now())},6e4);return function(){clearInterval(e)}},[u]);var w=s.useCallback(function(){g(function(e){return e-hourWindowToOffset(u)})},[u]),S=s.useCallback(function(){g(function(e){return e+hourWindowToOffset(u)})},[u]),_=s.useCallback(function(){g(0)},[]),A=s.useMemo(function(){return[p-36e5*Number(u)+v,p+36e5+v]},[u,p,v]),C=useRunsForTimeline(A),E=C.jobs,R=C.initialLoading,I=C.queryData,z=(0,k.C4)(I,k.dT),N=s.useMemo(function(){var e=y.toLocaleLowerCase().trim(),t=a.flatMap(function(t){var n=(0,et.kQ)(t.repository.name,t.repositoryLocation.name);return t.repository.pipelines.filter(function(t){return t.name.toLocaleLowerCase().includes(e)}).map(function(e){return makeJobKey(n,e.name)})});return new Set(t)},[a,y]),P=s.useMemo(function(){return E.filter(function(e){var t=e.key;return N.has(t)})},[E,N]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t,{refreshState:z}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[(0,i.jsx)(n,{selected:"timeline"}),o.length>1&&(0,i.jsx)(RepoFilterButton,{}),(0,i.jsx)(eV.oi,{icon:"search",value:y,onChange:function(e){return b(e.target.value)},placeholder:"Filter by job name…",style:{width:"200px"}})]}),(0,i.jsxs)(m.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,i.jsx)(L.h,{activeItems:new Set([u]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:function(e){return d(e)}}),(0,i.jsxs)(m.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,i.jsx)(eM.zx,{onClick:w,children:"←"}),(0,i.jsx)(eM.zx,{onClick:_,children:"Now"}),(0,i.jsx)(eM.zx,{onClick:S,children:"→"})]})]})]}),(0,i.jsx)(e5.S,{region:"timeline",children:(0,i.jsx)(te.q,{loading:R,range:A,jobs:P})})]})},OverviewActivityRoot=function(){(0,O.Px)(),(0,ex.j)("Overview | Activity");var e=s.useCallback(function(e){var t=e.refreshState;return(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"activity",refreshState:t})})},[]),t=(0,c._)((0,eK.U)("overview-activity-tab",function(e){return["timeline","assets"].includes(e)?e:"timeline"}),2),n=t[0],r=t[1],a=s.useCallback(function(e){var t=e.selected;return n!==t&&r(t),(0,i.jsxs)(eM.zH,{children:[(0,i.jsx)(e$.Q1,{$active:"timeline"===t,to:"/overview/activity/timeline",children:"Timeline"}),(0,i.jsx)(e$.Q1,{$active:"assets"===t,to:"/overview/activity/assets",children:"Assets"})]})},[n,r]);return(0,i.jsx)(m.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:(0,i.jsxs)(o.rs,{children:[(0,i.jsx)(o.AW,{path:"/overview/activity/assets",children:(0,i.jsx)(OverviewAssetsRoot,{Header:e,TabButton:a})}),(0,i.jsx)(o.AW,{path:"/overview/activity/timeline",children:(0,i.jsx)(OverviewTimelineRoot,{Header:e,TabButton:a})}),(0,i.jsx)(o.AW,{path:"*",render:s.useCallback(function(){return"timeline"===n?(0,i.jsx)(o.l_,{to:"/overview/activity/timeline"}):(0,i.jsx)(o.l_,{to:"/overview/activity/assets"})},[n])})]})})},useDelayedState=function(e){var t=(0,c._)(s.useState(!1),2),n=t[0],r=t[1];return s.useEffect(function(){var t=setTimeout(function(){return r(!0)},e);return function(){return clearTimeout(t)}},[e]),n},ta=n(43180),SearchInputSpinner=function(e){var t=e.tooltipContent;return useDelayedState(2e3)?(0,i.jsx)(m.x,{margin:{top:1},children:(0,i.jsx)(ta.u,{placement:"top",canShow:!!t,content:t||"",children:(0,i.jsx)(y.$,{purpose:"body-text"})})}):null},tl=n(77277),tc=n(42885),tu=n(9901),td=n(86839),th=n(68884),OverviewJobsTable=function(e){var t=e.repos,n=s.useRef(null),r=s.useMemo(function(){return t.map(function(e){var t=e.repoAddress;return(0,tn.Uz)(t)})},[t]),o=(0,tc.N)(th.y,r),a=o.expandedKeys,l=o.onToggle,c=o.onToggleAll,u=s.useMemo(function(){var e=[];return t.forEach(function(t){var n=t.repoAddress,r=t.jobs;e.push({type:"header",repoAddress:n,jobCount:r.length});var i=(0,tn.Uz)(n);a.includes(i)&&r.forEach(function(t){var r=t.isJob,i=t.name;e.push({type:"job",repoAddress:n,isJob:r,name:i})})}),e},[t,a]),d=(0,tl.w)(t.map(function(e){return e.repoAddress.name})),h=(0,Q.useVirtualizer)({count:u.length,getScrollElement:function(){return n.current},estimateSize:function(e){var t=u[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),p=h.getTotalSize(),f=h.getVirtualItems();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tu.I,{}),(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsx)(ee.W2,{ref:n,children:(0,i.jsx)(ee.Nh,{$totalHeight:p,children:f.map(function(e){var t=e.index,n=e.key,r=e.size,s=e.start,o=u[t];return"header"===o.type?(0,i.jsx)(td.vG,{repoAddress:o.repoAddress,height:r,start:s,onToggle:l,onToggleAll:c,expanded:a.includes((0,tn.Uz)(o.repoAddress)),showLocation:d.has(o.repoAddress.name),rightElement:(0,i.jsx)(ta.u,{content:1===o.jobCount?"1 job":"".concat(o.jobCount," jobs"),placement:"top",children:(0,i.jsx)(eO.V,{children:o.jobCount})})},n):(0,i.jsx)(tu.b,{name:o.name,isJob:o.isJob,repoAddress:o.repoAddress,height:r,start:s},n)})})})})]})},sortRepoBuckets=function(e){return(0,u._)(e).sort(function(e,t){var n=(0,tn.Uz)(e.repoAddress),r=(0,tn.Uz)(t.repoAddress);return n.localeCompare(r)})},visibleRepoKeys=function(e){return new Set(e.map(function(e){return(0,tn.Uz)((0,et.kQ)(e.repository.name,e.repositoryLocation.name))}))};function OverviewJobsRoot_templateObject(){var e=(0,z._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return OverviewJobsRoot_templateObject=function(){return e},e}var OverviewJobsRoot=function(){(0,O.Px)(),(0,ex.j)("Overview | Jobs");var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.loading,o=(0,c._)((0,T.q)({queryKey:"search",defaults:{search:""}}),2),a=o[0],l=o[1],u=t.length,d=(0,W.a)(tp,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),h=d.data,p=d.loading,g=(0,k.C4)(d,k.dT),j=s.useMemo(function(){var e=visibleRepoKeys(n);return buildBuckets(h).filter(function(t){var n=t.repoAddress;return e.has((0,tn.Uz)(n))})},[h,n]),b=a.trim().toLocaleLowerCase(),w=b.length>0,S=s.useMemo(function(){var e=b.toLocaleLowerCase();return j.map(function(t){return{repoAddress:t.repoAddress,jobs:t.jobs.filter(function(t){return t.name.toLocaleLowerCase().includes(e)})}}).filter(function(e){return e.jobs.length>0})},[j,b]),_=r&&!u||p&&!h;return(0,i.jsxs)(m.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"jobs",refreshState:g})}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[u>1?(0,i.jsx)(RepoFilterButton,{}):null,(0,i.jsx)(eV.oi,{icon:"search",value:a,rightElement:_?(0,i.jsx)(SearchInputSpinner,{tooltipContent:"Loading jobs…"}):void 0,onChange:function(e){return l(e.target.value)},placeholder:"Filter by job name…",style:{width:"340px"}})]}),p&&!u?(0,i.jsx)(m.x,{padding:64,children:(0,i.jsx)(y.$,{purpose:"page"})}):function(){if(p&&!h)return(0,i.jsx)(m.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(y.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:v.w.Gray600},children:"Loading jobs…"})]})});var e=t.length>n.length;return S.length?(0,i.jsx)(OverviewJobsTable,{repos:S}):w?(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No matching jobs",description:e?(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},buildBuckets=function(e){if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];var t=e.workspaceOrError.locationEntries.map(function(e){return e.locationOrLoadError}),n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;if((null==l?void 0:l.__typename)==="RepositoryLocation"){var c=!0,u=!1,d=void 0;try{for(var h,p=l.repositories[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value,x=f.name,m=f.pipelines,v=(0,et.kQ)(x,l.name),g=m.filter(function(e){var t=e.name;return!(0,X.pv)(t)}).map(function(e){return{isJob:e.isJob,name:e.name}});g.length>0&&n.push({repoAddress:v,jobs:g})}}catch(e){u=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(e){i=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return sortRepoBuckets(n)},tp=(0,N.Ps)(OverviewJobsRoot_templateObject(),P.B),tf=n(76588),tx=n(98319),OverviewResourcesTable=function(e){var t=e.repos,n=s.useRef(null),r=s.useMemo(function(){return t.map(function(e){var t=e.repoAddress;return(0,tn.Uz)(t)})},[t]),o=(0,tc.N)(th.y,r),a=o.expandedKeys,c=o.onToggle,u=o.onToggleAll,d=s.useMemo(function(){var e=[];return t.forEach(function(t){var n=t.repoAddress,r=t.resources;e.push({type:"header",repoAddress:n,resourceCount:r.length});var i=(0,tn.Uz)(n);a.includes(i)&&r.forEach(function(t){e.push((0,l._)({type:"resource",repoAddress:n},t))})}),e},[t,a]),h=(0,tl.w)(t.map(function(e){return e.repoAddress.name})),p=(0,Q.useVirtualizer)({count:d.length,getScrollElement:function(){return n.current},estimateSize:function(e){var t=d[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),f=p.getTotalSize(),x=p.getVirtualItems();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tx.f,{}),(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsx)(ee.W2,{ref:n,children:(0,i.jsx)(ee.Nh,{$totalHeight:f,children:x.map(function(e){var t=e.index,n=e.key,r=e.size,s=e.start,o=d[t];return"header"===o.type?(0,i.jsx)(td.vG,{repoAddress:o.repoAddress,height:r,start:s,onToggle:c,onToggleAll:u,expanded:a.includes((0,tn.Uz)(o.repoAddress)),showLocation:h.has(o.repoAddress.name),rightElement:(0,i.jsx)(ta.u,{content:1===o.resourceCount?"1 resource":"".concat(o.resourceCount," resources"),placement:"top",children:(0,i.jsx)(eO.V,{children:o.resourceCount})})},n):(0,i.jsx)(tx.K,(0,l._)({height:r,start:s},o),n)})})})})]})};function OverviewResourcesRoot_templateObject(){var e=(0,z._)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  id\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return OverviewResourcesRoot_templateObject=function(){return e},e}var OverviewResourcesRoot=function(){(0,O.Px)(),(0,ex.j)("Overview | Resources");var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.loading,o=(0,c._)((0,T.q)({queryKey:"search",defaults:{search:""}}),2),a=o[0],l=o[1],u=t.length,d=(0,W.a)(tm,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),h=d.data,p=d.loading,g=(0,k.C4)(d,k.dT),j=s.useMemo(function(){var e=visibleRepoKeys(n);return OverviewResourcesRoot_buildBuckets(h).filter(function(t){var n=t.repoAddress;return e.has((0,tn.Uz)(n))})},[h,n]),b=a.trim().toLocaleLowerCase(),w=b.length>0,S=s.useMemo(function(){var e=b.toLocaleLowerCase();return j.map(function(t){return{repoAddress:t.repoAddress,resources:t.resources.filter(function(t){return t.name.toLocaleLowerCase().includes(e)})}}).filter(function(e){return e.resources.length>0})},[j,b]),_=r&&!u||p&&!h;return(0,i.jsxs)(m.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"resources",refreshState:g})}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[u>1?(0,i.jsx)(RepoFilterButton,{}):null,(0,i.jsx)(eV.oi,{icon:"search",value:a,rightElement:_?(0,i.jsx)(SearchInputSpinner,{tooltipContent:"Loading resources…"}):void 0,onChange:function(e){return l(e.target.value)},placeholder:"Filter by resource name…",style:{width:"340px"}})]}),p&&!u?(0,i.jsx)(m.x,{padding:64,children:(0,i.jsx)(y.$,{purpose:"page"})}):function(){if(p&&!h)return(0,i.jsx)(m.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(y.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:v.w.Gray600},children:"Loading resources…"})]})});var e=t.length>n.length;return S.length?(0,i.jsx)(OverviewResourcesTable,{repos:S}):w?(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No matching resources",description:e?(0,i.jsxs)("div",{children:["No resources matching ",(0,i.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No resources matching ",(0,i.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No resources",description:e?"No resources were found in the selected code locations":"No resources were found in your definitions"})})}()]})},OverviewResourcesRoot_buildBuckets=function(e){if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];var t=e.workspaceOrError.locationEntries.map(function(e){return e.locationOrLoadError}),n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;if((null==l?void 0:l.__typename)==="RepositoryLocation"){var c=!0,u=!1,d=void 0;try{for(var h,p=l.repositories[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value,x=f.name,m=f.allTopLevelResourceDetails,v=(0,et.kQ)(x,l.name);m.length>0&&n.push({repoAddress:v,resources:m})}}catch(e){u=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(e){i=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return sortRepoBuckets(n)},tm=(0,N.Ps)(OverviewResourcesRoot_templateObject(),P.B,tf.L),tv=n(2281),tg=n(73689),tj=n(49280),ty=n(33379),tb=n(59692),tw=n(55055),tS=n(54483),tk=n(57981),tO=n(56284),UnloadableSensors=function(e){var t=e.sensorStates,n=e.showSubheading;return t.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.x,{padding:{vertical:16,horizontal:20},children:[void 0===n||n?(0,i.jsx)(x.pm,{children:"Unloadable sensors"}):null,(0,i.jsx)(UnloadableSensorInfo,{})]}),(0,i.jsxs)(j.i,{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{maxWidth:"60px"}}),(0,i.jsx)("th",{children:"Sensor name"}),(0,i.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,i.jsx)("th",{children:"Last run"})]})}),(0,i.jsx)("tbody",{children:t.map(function(e){return(0,i.jsx)(SensorStateRow,{sensorState:e},e.id)})})]})]}):null},UnloadableSchedules=function(e){var t=e.scheduleStates,n=e.showSubheading;return t.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.x,{padding:{vertical:16,horizontal:20},children:[void 0===n||n?(0,i.jsx)(x.pm,{children:"Unloadable schedules"}):null,(0,i.jsx)(UnloadableScheduleInfo,{})]}),(0,i.jsxs)(j.i,{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{maxWidth:"60px"}}),(0,i.jsx)("th",{children:"Schedule name"}),(0,i.jsx)("th",{style:{width:"150px"},children:"Schedule"}),(0,i.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,i.jsx)("th",{children:"Last run"}),(0,i.jsx)("th",{children:"Partition set status"})]})}),(0,i.jsx)("tbody",{children:t.map(function(e){return(0,i.jsx)(ScheduleStateRow,{scheduleState:e},e.id)})})]})]}):null},UnloadableSensorInfo=function(){return(0,i.jsx)(g.b,{intent:"warning",title:(0,i.jsxs)("div",{children:["Note: You can turn off any of the following sensors, but you cannot turn them back on."," "]}),description:(0,i.jsx)("div",{children:"The following sensors were previously started but now cannot be loaded. They may be part of a different workspace or from a sensor or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can’t be loaded."})})},UnloadableScheduleInfo=function(){return(0,i.jsx)(g.b,{intent:"warning",title:(0,i.jsx)("div",{children:"Note: You can turn off any of the following schedules, but you cannot turn them back on."}),description:(0,i.jsx)("div",{children:"The following schedules were previously started but now cannot be loaded. They may be part of a different workspace or from a schedule or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can’t be loaded."})})},SensorStateRow=function(e){var t,n,r=e.sensorState,s=r.id,o=r.selectorId,l=r.name,u=r.status,h=r.ticks,p=r.hasStopPermission,f=(0,c._)((0,ty.D)(tk.Xu,{onCompleted:tk.oI}),2),x=f[0],m=f[1].loading,g=(0,w.p)(),j=(t=(0,a._)(function(){return(0,d.Jh)(this,function(e){switch(e.label){case 0:if(u!==_.ynu.RUNNING)return[3,2];return[4,g({title:"Are you sure you want to turn off this sensor?",description:"The definition for this sensor is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."})];case 1:e.sent(),x({variables:{jobOriginId:s,jobSelectorId:o}}),e.label=2;case 2:return[2]}})}),function(){return t.apply(this,arguments)}),y=u===_.ynu.RUNNING&&!p,k=h.length?h[0]:null;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{width:60},children:(n=(0,i.jsx)(b.X,{format:"switch",disabled:m||u===_.ynu.STOPPED||y,checked:u===_.ynu.RUNNING,onChange:j}),y?(0,i.jsx)(ta.u,{content:S.Qr,children:n}):n)}),(0,i.jsxs)("td",{children:[(0,i.jsx)(tb.Z,{direction:"row",spacing:8,alignItems:"center",children:l}),(0,i.jsx)(tO.Y,{instigatorState:r})]}),(0,i.jsx)("td",{children:k?(0,i.jsx)(V.a,{tick:k}):(0,i.jsx)("span",{style:{color:v.w.Gray300},children:"None"})}),(0,i.jsx)("td",{children:(0,i.jsx)("div",{style:{display:"flex"},children:(0,i.jsx)(tj.UD,{instigationState:r})})})]},l)},ScheduleStateRow=function(e){var t,n,r=e.scheduleState,s=(0,c._)((0,ty.D)(tw.d0,{onCompleted:tw.JH}),2),o=s[0],l=s[1].loading,u=(0,w.p)(),h=r.id,p=r.selectorId,f=r.name,x=r.ticks,m=r.status,v=r.typeSpecificData,g=x.length>0?x[0]:null,j=v&&"ScheduleData"===v.__typename?v.cronSchedule:null,y=(t=(0,a._)(function(){return(0,d.Jh)(this,function(e){switch(e.label){case 0:if(m!==_.ynu.RUNNING)return[3,2];return[4,u({title:"Are you sure you want to stop this schedule?",description:"The definition for this schedule is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."})];case 1:e.sent(),o({variables:{scheduleOriginId:h,scheduleSelectorId:p}}),e.label=2;case 2:return[2]}})}),function(){return t.apply(this,arguments)}),k=m===_.ynu.RUNNING&&!r.hasStopPermission;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{width:60},children:(n=(0,i.jsx)(b.X,{format:"switch",checked:m===_.ynu.RUNNING,disabled:m!==_.ynu.RUNNING||l||k,onChange:y}),k?(0,i.jsx)(ta.u,{content:S.Qr,children:n}):n)}),(0,i.jsxs)("td",{children:[(0,i.jsx)(tb.Z,{direction:"row",spacing:8,alignItems:"center",children:(0,i.jsx)("div",{children:f})}),(0,i.jsx)(tO.Y,{instigatorState:r})]}),(0,i.jsx)("td",{style:{maxWidth:150},children:(0,i.jsx)("div",{style:{position:"relative",width:"100%",whiteSpace:"pre-wrap",display:"block"},children:j?(0,i.jsx)(ta.u,{position:"bottom",content:j,children:(0,tS.A)(j)}):(0,i.jsx)("div",{children:"—"})})}),(0,i.jsx)("td",{children:g?(0,i.jsx)(V.a,{tick:g}):null}),(0,i.jsx)("td",{children:(0,i.jsx)(tj.UD,{instigationState:r})}),(0,i.jsx)("td",{children:(0,i.jsx)("div",{style:{display:"flex"},children:"—"})})]},f)},t_=n(30894),tT=n(24808),tA=n(84826),tC=n(157),tE=n(30682),tR=n(10397),useCodeLocationFilter=function(){var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.setVisible,o=e.setHidden,a=s.useMemo(function(){return t.map(function(e){return(0,et.kQ)(e.repository.name,e.repositoryLocation.name)})},[t]),l=s.useMemo(function(){return n.length===t.length?[]:n.map(function(e){return(0,et.kQ)(e.repository.name,e.repositoryLocation.name)})},[t,n]);return(0,eg.im)({name:"Code location",icon:"folder",initialState:l,allValues:a.map(function(e){return{value:e,match:[(0,tn.Uz)(e)]}}),getKey:function(e){return(0,tn.Uz)(e)},renderLabel:function(e){var t=e.value;return(0,i.jsx)(tR.rd,{text:(0,tn.Uz)(t)})},getStringValue:function(e){return(0,tn.Uz)(e)},onStateChanged:function(e){if(0===e.size){r(a);return}o(a.filter(function(t){return!e.has(t)})),r(Array.from(e))},menuWidth:"500px"})},tI=n(8223),tz=n(72855),tN=n(72349),OverviewScheduleTable=function(e){var t=e.repos,n=e.headerCheckbox,r=e.checkedKeys,o=e.onToggleCheckFactory,a=s.useRef(null),l=s.useMemo(function(){return t.map(function(e){var t=e.repoAddress;return(0,tn.Uz)(t)})},[t]),c=(0,tc.N)(th.y,l),u=c.expandedKeys,d=c.onToggle,h=c.onToggleAll,p=s.useMemo(function(){var e=[];return t.forEach(function(t){var n=t.repoAddress,r=t.schedules;e.push({type:"header",repoAddress:n,scheduleCount:r.length});var i=(0,tn.Uz)(n);u.includes(i)&&r.forEach(function(t){e.push({type:"schedule",repoAddress:n,schedule:t})})}),e},[t,u]),f=(0,tl.w)(t.map(function(e){return e.repoAddress.name})),x=(0,Q.useVirtualizer)({count:p.length,getScrollElement:function(){return a.current},estimateSize:function(e){var t=p[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),m=x.getTotalSize(),v=x.getVirtualItems();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tN.o,{checkbox:n}),(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsx)(ee.W2,{ref:a,children:(0,i.jsx)(ee.Nh,{$totalHeight:m,children:v.map(function(e){var t=e.index,s=e.key,a=e.size,l=e.start,c=p[t];if("header"===c.type)return(0,i.jsx)(td.vG,{repoAddress:c.repoAddress,height:a,start:l,onToggle:d,onToggleAll:h,expanded:u.includes((0,tn.Uz)(c.repoAddress)),showLocation:f.has(c.repoAddress.name),rightElement:(0,i.jsx)(ta.u,{content:1===c.scheduleCount?"1 schedule":"".concat(c.scheduleCount," schedules"),placement:"top",children:(0,i.jsx)(eO.V,{children:c.scheduleCount})})},s);var x=(0,tC.g)(c.repoAddress,c.schedule.name);return(0,i.jsx)(tN.i,{name:c.schedule.name,scheduleState:c.schedule.scheduleState,showCheckboxColumn:!!n,checked:r.has(x),onToggleChecked:o(x),repoAddress:c.repoAddress,height:a,start:l},s)})})})})]})};function OverviewSchedulesRoot_templateObject(){var e=(0,z._)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                  scheduleState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return OverviewSchedulesRoot_templateObject=function(){return e},e}function OverviewSchedulesRoot_templateObject1(){var e=(0,z._)(["\n  query UnloadableSchedulesQuery {\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return OverviewSchedulesRoot_templateObject1=function(){return e},e}var OverviewSchedulesRoot=function(){(0,O.Px)(),(0,ex.j)("Overview | Schedules");var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.loading,o=t.length,a=(0,c._)((0,T.q)({queryKey:"search",defaults:{search:""}}),2),u=a[0],d=a[1],h=useCodeLocationFilter(),p=(0,tI.g)(),g=s.useMemo(function(){return[h,p]},[h,p]),j=(0,ev.m)({filters:g}),b=j.button,w=j.activeFiltersJsx,S=(0,W.a)(tP,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),_=S.data,A=S.loading,C=(0,k.C4)(S,k.dT),E=s.useMemo(function(){var e=visibleRepoKeys(n);return OverviewSchedulesRoot_buildBuckets(_).filter(function(t){var n=t.repoAddress;return e.has((0,tn.Uz)(n))})},[_,n]),R=p.state,I=s.useMemo(function(){return E.map(function(e){var t=e.schedules,n=(0,tv._)(e,["schedules"]);return(0,eq._)((0,l._)({},n),{schedules:R.size?t.filter(function(e){var t=e.scheduleState;return R.has(t.status)}):t})})},[E,R]),z=u.trim().toLocaleLowerCase(),N=z.length>0,P=s.useMemo(function(){var e=z.toLocaleLowerCase();return I.map(function(t){return{repoAddress:t.repoAddress,schedules:t.schedules.filter(function(t){return t.name.toLocaleLowerCase().includes(e)})}}).filter(function(e){return e.schedules.length>0})},[I,z]),F=s.useMemo(function(){return P.some(function(e){return e.schedules.length>0})},[P]),B=s.useMemo(function(){return E.map(function(e){var t=e.repoAddress;return e.schedules.filter(function(e){var t=e.scheduleState;return(0,t_.i)(t)}).map(function(e){return{repoAddress:t,scheduleName:e.name,scheduleState:e.scheduleState}})}).flat()},[E]),L=s.useMemo(function(){return B.map(function(e){var t=e.repoAddress,n=e.scheduleName;return(0,tC.g)(t,n)})},[B]),U=(0,c._)((0,tg.a)(L),2),D=U[0].checkedIds,M=U[1],K=M.onToggleFactory,$=M.onToggleAll,q=s.useMemo(function(){var e=new Set(P.map(function(e){var t=e.repoAddress;return e.schedules.map(function(e){var n=e.name;return(0,tC.g)(t,n)})}).flat());return L.filter(function(t){return e.has(t)})},[L,P]),V=s.useMemo(function(){var e=new Set(q.filter(function(e){return D.has(e)}));return B.filter(function(t){var n=t.repoAddress,r=t.scheduleName;return e.has((0,tC.g)(n,r))})},[q,B,D]),J=L.length>0,G=V.length,H=r&&!o||A&&!_;return(0,i.jsxs)(m.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"schedules",refreshState:C})}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)(m.x,{flex:{direction:"row",gap:12},children:[b,(0,i.jsx)(eV.oi,{icon:"search",value:u,rightElement:H?(0,i.jsx)(SearchInputSpinner,{tooltipContent:"Loading schedules…"}):void 0,onChange:function(e){d(e.target.value),$(!1)},placeholder:"Filter by schedule name…",style:{width:"340px"}})]}),(0,i.jsx)(ta.u,{content:"You do not have permission to start or stop these schedules",canShow:F&&!J,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,i.jsx)(tT._,{schedules:V,onDone:function(){return C.refetch()}})})]}),w.length?(0,i.jsx)(m.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:w}):null,A&&!o?(0,i.jsx)(m.x,{padding:64,children:(0,i.jsx)(y.$,{purpose:"page"})}):(0,i.jsxs)(i.Fragment,{children:[(null==_?void 0:_.unloadableInstigationStatesOrError.__typename)==="InstigationStates"?(0,i.jsx)(UnloadableSchedulesAlert,{count:_.unloadableInstigationStatesOrError.results.length}):null,(0,i.jsx)(tA.K,{daemonHealth:null==_?void 0:_.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),function(){if(A&&!_)return(0,i.jsx)(m.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(y.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:v.w.Gray600},children:"Loading schedules…"})]})});var e=t.length>n.length;return P.length?(0,i.jsx)(OverviewScheduleTable,{headerCheckbox:J?(0,i.jsx)(tE.W,{checkedCount:G,totalCount:q.length,onToggleAll:$}):void 0,repos:P,checkedKeys:D,onToggleCheckFactory:K}):N?(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No matching schedules",description:e?(0,i.jsxs)("div",{children:["No schedules matching ",(0,i.jsx)("strong",{children:u})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No schedules matching ",(0,i.jsx)("strong",{children:u})," were found in your definitions"]})})}):(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No schedules",description:e?"No matching schedules were found in the selected code locations":"No matching schedules were found in your definitions"})})}()]})]})},UnloadableSchedulesAlert=function(e){var t=e.count,n=(0,c._)(s.useState(!1),2),r=n[0],o=n[1];return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.x,{padding:{vertical:16,horizontal:24},border:"top",children:(0,i.jsx)(g.b,{intent:"warning",title:1===t?"1 unloadable schedule":"".concat(t," unloadable schedules"),description:(0,i.jsxs)(m.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,i.jsx)("div",{children:"Schedules were previously started but now cannot be loaded. They may be part of a code locations that no longer exist. You can turn them off, but you cannot turn them back on."}),(0,i.jsx)(eM.zx,{onClick:function(){return o(!0)},children:1===t?"View unloadable schedule":"View unloadable schedules"})]})})}),(0,i.jsxs)(e8.Vq,{isOpen:r,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,i.jsx)(m.x,{padding:{bottom:8},children:(0,i.jsx)(UnloadableScheduleDialog,{})}),(0,i.jsx)(e8.cN,{children:(0,i.jsx)(eM.zx,{intent:"primary",onClick:function(){return o(!1)},children:"Done"})})]})]}):null},UnloadableScheduleDialog=function(){var e=(0,W.a)(tF).data;return e?(null==e?void 0:e.unloadableInstigationStatesOrError.__typename)==="InstigationStates"?(0,i.jsx)(UnloadableSchedules,{scheduleStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,i.jsx)(ef.T9,{error:null==e?void 0:e.unloadableInstigationStatesOrError}):(0,i.jsx)(y.$,{purpose:"section"})},OverviewSchedulesRoot_buildBuckets=function(e){if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];var t=e.workspaceOrError.locationEntries.map(function(e){return e.locationOrLoadError}),n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;if((null==l?void 0:l.__typename)==="RepositoryLocation"){var c=!0,u=!1,d=void 0;try{for(var h,p=l.repositories[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value,x=f.name,m=f.schedules,v=(0,et.kQ)(x,l.name),g=m.map(function(e){var t=e.name,n=e.scheduleState;return{name:t,scheduleState:n}});g.length>0&&n.push({repoAddress:v,schedules:g})}}catch(e){u=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(e){i=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return sortRepoBuckets(n)},tP=(0,N.Ps)(OverviewSchedulesRoot_templateObject(),tz.i,P.B,ej.O),tF=(0,N.Ps)(OverviewSchedulesRoot_templateObject1(),tj.ai,P.B),tB=n(67802),tL=n(56692),tU=n(22478),tD=n(16592),OverviewSensorTable=function(e){var t=e.repos,n=e.headerCheckbox,r=e.checkedKeys,o=e.onToggleCheckFactory,a=s.useRef(null),l=s.useMemo(function(){return t.map(function(e){var t=e.repoAddress;return(0,tn.Uz)(t)})},[t]),c=(0,tc.N)(th.y,l),u=c.expandedKeys,d=c.onToggle,h=c.onToggleAll,p=s.useMemo(function(){var e=[];return t.forEach(function(t){var n=t.repoAddress,r=t.sensors;e.push({type:"header",repoAddress:n,sensorCount:r.length});var i=(0,tn.Uz)(n);u.includes(i)&&r.forEach(function(t){e.push({type:"sensor",repoAddress:n,sensor:t})})}),e},[t,u]),f=(0,tl.w)(t.map(function(e){return e.repoAddress.name})),x=(0,Q.useVirtualizer)({count:p.length,getScrollElement:function(){return a.current},estimateSize:function(e){var t=p[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),m=x.getTotalSize(),v=x.getVirtualItems();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tD.K,{checkbox:n}),(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsx)(ee.W2,{ref:a,children:(0,i.jsx)(ee.Nh,{$totalHeight:m,children:v.map(function(e){var t=e.index,s=e.key,a=e.size,l=e.start,c=p[t];if("header"===c.type)return(0,i.jsx)(td.vG,{repoAddress:c.repoAddress,height:a,start:l,onToggle:d,onToggleAll:h,expanded:u.includes((0,tn.Uz)(c.repoAddress)),showLocation:f.has(c.repoAddress.name),rightElement:(0,i.jsx)(ta.u,{content:1===c.sensorCount?"1 sensor":"".concat(c.sensorCount," sensors"),placement:"top",children:(0,i.jsx)(eO.V,{children:c.sensorCount})})},s);var x=(0,tU.x)(c.repoAddress,c.sensor.name);return(0,i.jsx)(tD.R,{name:c.sensor.name,sensorState:c.sensor.sensorState,showCheckboxColumn:!!n,checked:r.has(x),onToggleChecked:o(x),repoAddress:c.repoAddress,height:a,start:l},s)})})})})]})};function OverviewSensorsRoot_templateObject(){var e=(0,z._)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                  sensorState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return OverviewSensorsRoot_templateObject=function(){return e},e}function OverviewSensorsRoot_templateObject1(){var e=(0,z._)(["\n  query UnloadableSensorsQuery {\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return OverviewSensorsRoot_templateObject1=function(){return e},e}var OverviewSensorsRoot=function(){(0,O.Px)(),(0,ex.j)("Overview | Sensors");var e=s.useContext(e7.C5),t=e.allRepos,n=e.visibleRepos,r=e.loading,o=t.length,a=(0,c._)((0,T.q)({queryKey:"search",defaults:{search:""}}),2),u=a[0],d=a[1],h=useCodeLocationFilter(),p=(0,tI.g)(),g=s.useMemo(function(){return[h,p]},[h,p]),j=(0,ev.m)({filters:g}),b=j.button,w=j.activeFiltersJsx,S=(0,W.a)(tM,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),_=S.data,A=S.loading,C=(0,k.C4)(S,k.dT),E=s.useMemo(function(){var e=visibleRepoKeys(n);return OverviewSensorsRoot_buildBuckets(_).filter(function(t){var n=t.repoAddress;return e.has((0,tn.Uz)(n))})},[_,n]),R=p.state,I=s.useMemo(function(){return E.map(function(e){var t=e.sensors,n=(0,tv._)(e,["sensors"]);return(0,eq._)((0,l._)({},n),{sensors:R.size?t.filter(function(e){var t=e.sensorState;return R.has(t.status)}):t})})},[E,R]),z=u.trim().toLocaleLowerCase(),N=z.length>0,P=s.useMemo(function(){var e=z.toLocaleLowerCase();return I.map(function(t){return{repoAddress:t.repoAddress,sensors:t.sensors.filter(function(t){return t.name.toLocaleLowerCase().includes(e)})}}).filter(function(e){return e.sensors.length>0})},[I,z]),F=s.useMemo(function(){return P.some(function(e){return e.sensors.length>0})},[P]),B=s.useMemo(function(){return E.map(function(e){var t=e.repoAddress;return e.sensors.filter(function(e){var t=e.sensorState;return(0,t_.i)(t)}).map(function(e){return{repoAddress:t,sensorName:e.name,sensorState:e.sensorState}})}).flat()},[E]),L=s.useMemo(function(){return B.map(function(e){var t=e.repoAddress,n=e.sensorName;return(0,tU.x)(t,n)})},[B]),U=(0,c._)((0,tg.a)(L),2),D=U[0].checkedIds,M=U[1],K=M.onToggleFactory,$=M.onToggleAll,q=s.useMemo(function(){var e=new Set(P.map(function(e){var t=e.repoAddress;return e.sensors.map(function(e){var n=e.name;return(0,tU.x)(t,n)})}).flat());return L.filter(function(t){return e.has(t)})},[L,P]),V=s.useMemo(function(){var e=new Set(q.filter(function(e){return D.has(e)}));return B.filter(function(t){var n=t.repoAddress,r=t.sensorName;return e.has((0,tU.x)(n,r))})},[q,B,D]),J=L.length>0,G=V.length,H=r&&!o||A&&!_;return(0,i.jsxs)(m.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,i.jsx)(f.m,{title:(0,i.jsx)(x.X6,{children:"Overview"}),tabs:(0,i.jsx)(OverviewTabs,{tab:"sensors",refreshState:C})}),(0,i.jsxs)(m.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",gap:12,grow:0},children:[(0,i.jsxs)(m.x,{flex:{direction:"row",gap:12},children:[b,(0,i.jsx)(eV.oi,{icon:"search",value:u,rightElement:H?(0,i.jsx)(SearchInputSpinner,{tooltipContent:"Loading sensors…"}):void 0,onChange:function(e){return d(e.target.value)},placeholder:"Filter by sensor name…",style:{width:"340px"}})]}),(0,i.jsx)(ta.u,{content:"You do not have permission to start or stop these schedules",canShow:F&&!J,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,i.jsx)(tB.b,{sensors:V,onDone:function(){return C.refetch()}})})]}),w.length?(0,i.jsx)(m.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:w}):null,A&&!o?(0,i.jsx)(m.x,{padding:64,children:(0,i.jsx)(y.$,{purpose:"page"})}):(0,i.jsxs)(i.Fragment,{children:[(null==_?void 0:_.unloadableInstigationStatesOrError.__typename)==="InstigationStates"?(0,i.jsx)(UnloadableSensorsAlert,{count:_.unloadableInstigationStatesOrError.results.length}):null,(0,i.jsx)(tL.F,{daemonHealth:null==_?void 0:_.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),function(){if(A&&!_)return(0,i.jsx)(m.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(m.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(y.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:v.w.Gray600},children:"Loading sensors…"})]})});var e=t.length>n.length;return P.length?(0,i.jsx)(OverviewSensorTable,{headerCheckbox:J?(0,i.jsx)(tE.W,{checkedCount:G,totalCount:q.length,onToggleAll:$}):void 0,repos:P,checkedKeys:D,onToggleCheckFactory:K}):N?(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No matching sensors",description:e?(0,i.jsxs)("div",{children:["No sensors matching ",(0,i.jsx)("strong",{children:u})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No sensors matching ",(0,i.jsx)("strong",{children:u})," were found in your definitions"]})})}):(0,i.jsx)(m.x,{padding:{top:20},children:(0,i.jsx)(ep.t,{icon:"search",title:"No sensors",description:e?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})}()]})]})},UnloadableSensorsAlert=function(e){var t=e.count,n=(0,c._)(s.useState(!1),2),r=n[0],o=n[1];return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.x,{padding:{vertical:16,horizontal:24},border:"top",children:(0,i.jsx)(g.b,{intent:"warning",title:1===t?"1 unloadable sensor":"".concat(t," unloadable sensors"),description:(0,i.jsxs)(m.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,i.jsx)("div",{children:"Sensors were previously started but now cannot be loaded. They may be part of a code location that no longer exists. You can turn them off, but you cannot turn them back on."}),(0,i.jsx)(eM.zx,{onClick:function(){return o(!0)},children:1===t?"View unloadable sensor":"View unloadable sensors"})]})})}),(0,i.jsxs)(e8.Vq,{isOpen:r,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,i.jsx)(m.x,{padding:{bottom:8},children:(0,i.jsx)(UnloadableSensorDialog,{})}),(0,i.jsx)(e8.cN,{children:(0,i.jsx)(eM.zx,{intent:"primary",onClick:function(){return o(!1)},children:"Done"})})]})]}):null},UnloadableSensorDialog=function(){var e=(0,W.a)(tK).data;return e?(null==e?void 0:e.unloadableInstigationStatesOrError.__typename)==="InstigationStates"?(0,i.jsx)(UnloadableSensors,{sensorStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,i.jsx)(ef.T9,{error:null==e?void 0:e.unloadableInstigationStatesOrError}):(0,i.jsx)(y.$,{purpose:"section"})},OverviewSensorsRoot_buildBuckets=function(e){if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];var t=e.workspaceOrError.locationEntries.map(function(e){return e.locationOrLoadError}),n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;if((null==l?void 0:l.__typename)==="RepositoryLocation"){var c=!0,u=!1,d=void 0;try{for(var h,p=l.repositories[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value,x=f.name,m=f.sensors,v=(0,et.kQ)(x,l.name);m.length>0&&n.push({repoAddress:v,sensors:m})}}catch(e){u=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(e){i=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return sortRepoBuckets(n)},tM=(0,N.Ps)(OverviewSensorsRoot_templateObject(),tz.i,P.B,ej.O),tK=(0,N.Ps)(OverviewSensorsRoot_templateObject1(),tj.ai,P.B),OverviewRoot=function(){return(0,i.jsxs)(o.rs,{children:[(0,i.jsx)(o.AW,{path:"/overview/activity",children:(0,i.jsx)(OverviewActivityRoot,{})}),(0,i.jsx)(o.AW,{path:"/overview/jobs",children:(0,i.jsx)(OverviewJobsRoot,{})}),(0,i.jsx)(o.AW,{path:"/overview/schedules",children:(0,i.jsx)(OverviewSchedulesRoot,{})}),(0,i.jsx)(o.AW,{path:"/overview/sensors",children:(0,i.jsx)(OverviewSensorsRoot,{})}),(0,i.jsx)(o.AW,{path:"/overview/automaterialize",children:(0,i.jsx)(AutomaterializationRoot,{})}),(0,i.jsx)(o.AW,{path:"/overview/backfills/:backfillId",children:(0,i.jsx)(BackfillPage,{})}),(0,i.jsx)(o.AW,{path:"/overview/backfills",exact:!0,children:(0,i.jsx)(InstanceBackfills,{})}),(0,i.jsx)(o.AW,{path:"/overview/resources",children:(0,i.jsx)(OverviewResourcesRoot,{})}),(0,i.jsx)(o.AW,{path:"*",render:function(){return(0,i.jsx)(o.l_,{to:"/overview/activity"})}})]})},t$=OverviewRoot}}]);
//# sourceMappingURL=916.84f63714276622b6.js.map